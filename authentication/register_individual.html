<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Individual Registration</title>
</head>
<body>
    <h1>Individual Registration</h1>
    <button id="connectWalletBtn">Connect Wallet</button>
    <button id="googleSignInBtn" disabled>Sign in with Google</button>

    <script src="../assets/script_common.js"></script>
    <script src="https://cdn.auth0.com/js/auth0/9.19/auth0.min.js"></script>
    <script>
      console.log("AUTH0_DOMAIN:", AUTH0_DOMAIN);
      console.log("AUTH0_CLIENT_ID:", AUTH0_CLIENT_ID);
      console.log("FRONTEND_URL:", FRONTEND_URL);
      console.log("RETRY_URL:", RETRY_URL);
  </script>
  
    <script>
      var auth0 = new auth0.WebAuth({
          domain: env.AUTH0_DOMAIN,
          clientID: env.AUTH0_CLIENT_ID,
          redirectUri: env.FRONTEND_URL,
          retry: env.RETRY_URL,
          responseType: 'token id_token',
          scope: 'openid profile email'
      });

      var googleSignInBtn = document.getElementById('googleSignInBtn');

      googleSignInBtn.addEventListener('click', function() {
          auth0.authorize({
              connection: 'google'
          });
      });

      // Check if there are tokens in the URL hash indicating a successful authentication
      var handleAuthentication = function() {
          auth0.parseHash(function(err, authResult) {
              if (authResult && authResult.accessToken && authResult.idToken) {
                  // Save tokens to local storage or session storage if needed
                  window.location.href = env.FRONTEND_URL;
              } else if (err) {
                  console.error('Authentication error:', err);
                  window.location.href = env.RETRY_URL;
              }
          });
      };

      // Call the function to handle authentication when the page loads
      handleAuthentication();
  </script>
</body>
</html>